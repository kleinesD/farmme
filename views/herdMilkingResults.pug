extends base

block content
  include _rcmHerd
  section.main-section 

    include _animalHeader
    .animal-results-window

      //-.animal-results-history
        .ar-block-title.ar-block-title-chart История результатов
        -if(animal.milkingResults.length > 3)
          .animal-results-data-box  
            each result in animal.milkingResults 
              .animal-result-data(data-date=`${result.date}` data-result=`${result.result}` data-lact-number=`${result.lactationNumber}` data-index=`${animal.milkingResults.indexOf(result)}`)
          .animal-results-average-box  
            each anim in animals 
              each result in anim.milkingResults 
                .animal-average-data(data-date=`${result.date}` data-result=`${result.result}` data-lact-number=`${result.lactationNumber}`)
          svg.graph-canvas#the-graph(width="150" height="100" data-animal-id=`${animal._id}`) 
          .history-graph-tooltip#history-graph-tooltip
            .hgt-header-line
              img(src="/img/images/default-cow-image.png")
              .hgt-header-line-info
                .hgt-number= `#${animal.number}`
                -if(animal.name)
                  .hgt-name= animal.name
            .hgt-result-line#date-line
              p Дата:
              p#tooltip-date 26.01.2001
            .hgt-result-line#result-line
              p Результат:
              p#tooltip-result 25 л.
            .hgt-result-line#lactation-line
              p Лактация:
              p#tooltip-lactation #3
            a.hgt-edit-btn(href="#") Редактировать 
        -else
          .ar-empty-history-block
            img(src="/img/images/no-data-image.png")
            p Слишком мало данных
          
        .ar-tip-container 
          .ar-tip-icon 
            ion-icon(name="bulb")
          .ar-tip-text Мы любим животных и стараемся поддерживать тех из них, кому не посчастливилось иметь ласковых хозяев и тёплый кров. Один из проверенных способов это сделать — помочь приюту для животных Домашний. У этих ребят живёт более 1500 четвероногих, и благодаря их труду ежегодно сотни питомцев находят свой новый дом.

      -if(!forEdit)
        .ai-form-container.ai-form-container-headerful#milking-results-container
          .ai-block-sub-title ДОБАВИТЬ
          .ai-block-title Контрольное доение
          
          .ai-double-input-block
            .ai-input-block-half.ai-input-block-text
              .ai-input-label Результат
              input.ai-input.ai-input-half.ai-input-half-text#result(type="number")
              .ai-inside-text л.
            .ai-input-block-half.ai-input-block-text
              .ai-input-label Дата
              input.ai-input.ai-input-half.ai-input-half-date.ai-input-validation#result-date(type="date")
            .ai-input-marker.ai-input-marker-r
              ion-icon(name="alert")
            .ai-input-explain-block.ai-input-explain-block-required
              .ai-input-eb-tri
              .ai-input-eb-text Обязательно

          .ai-input-block.ai-input-block-pick.ai-input-block-pick-one#lactation-number
            .ai-input-label Лактация
            each lact in animal.lactations
              .ai-pick.ai-pick-restricted(data-number=`${lact.number}` data-start-date=`${lact.startDate}` data-finish-date=`${lact.finishDate === null || undefined ? new Date() : lact.finishDate}` data-finish-date-exist=`${lact.finishDate === null || undefined ? false : true}`)= `#${lact.number}`

                   
          .ai-input-submit-btn(data-animal-id=`${animal._id}`) Сохранить

      -if(forEdit)
        .ai-form-container.ai-form-container-headerful#edit-milking-results-container
          .ai-block-sub-title РЕДАКТИРОВАТЬ
          .ai-block-title Контрольное доение

          .ai-double-input-block
            .ai-input-block-half.ai-input-block-text
              .ai-input-label Результат
              input.ai-input.ai-input-half.ai-input-half-text#result(type="number"  value=`${result.result}`)
              .ai-inside-text л.
            .ai-input-block-half.ai-input-block-text
              .ai-input-label Дата
              input.ai-input.ai-input-half.ai-input-half-date.ai-input-validation#result-date(type="date" value=`${result.date.toLocaleString('ru-RU', {year: 'numeric'})}-${result.date.toLocaleString('ru-RU', {month: '2-digit'})}-${result.date.toLocaleString('ru-RU', {day: '2-digit'})}`)
            .ai-input-marker.ai-input-marker-r
              ion-icon(name="alert")
            .ai-input-explain-block.ai-input-explain-block-required
              .ai-input-eb-tri
              .ai-input-eb-text Обязательно
          .ai-input-block.ai-input-block-pick.ai-input-block-pick-one#lactation-number
            .ai-input-label Лактация
            each lact in animal.lactations
              .ai-pick.ai-pick-restricted(data-number=`${lact.number}` data-start-date=`${lact.startDate}` data-finish-date=`${lact.finishDate === null || undefined ? new Date() : lact.finishDate}` data-finish-date-exist=`${lact.finishDate === null || undefined ? false : true}`)= `#${lact.number}`

          .ai-input-submit-btn(data-animal-id=`${animal._id}` data-index=`${index}`) Сохранить


 
